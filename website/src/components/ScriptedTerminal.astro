---
/**
 * ScriptedTerminal - Renders demo terminal from content
 */
import TerminalWindow from './TerminalWindow.astro';
import { getCollection } from 'astro:content';
import type { DemoTerminalEntry } from '../types/homepage';

const allContent = await getCollection('homepage');
const entry = allContent.find(
  (e): e is DemoTerminalEntry => e.data.type === 'demo-terminal'
);

if (!entry) throw new Error('Demo terminal content not found');
---

<TerminalWindow title="Terminal" copyText={entry.data.command}>
  <div class="terminal-line">
    <span class="terminal-prompt">$</span>
    <span class="terminal-command">{entry.data.command}</span>
  </div>

  <div class="terminal-output">
    <div class="output-line">üîç <span class="output-header">Documentation Health Check</span></div>
    <div class="output-line tier-hot">
      <span class="tier-label">‚úÖ Mandatory files:</span>
      <span class="tier-value">All required governance docs present</span>
    </div>
    <div class="output-line tier-warm">
      <span class="tier-label">‚úÖ Structure validation:</span>
      <span class="tier-value">Proper HOT/WARM/COLD organization</span>
    </div>
    <div class="output-line tier-cold">
      <span class="tier-label">‚úÖ Size limits:</span>
      <span class="tier-value">Documentation within reasonable bounds</span>
    </div>
    <div class="output-line cost-line">
      ‚ö†Ô∏è <span class="cost-label">Staleness detected:</span>
      <span class="cost-value">PATTERNS.md unchanged for 45 days</span>
    </div>
  </div>
</TerminalWindow>

<style>
  .terminal-line   { margin-bottom: 1rem; }
  .terminal-prompt { color: var(--sl-color-accent); margin-right: 0.5rem; user-select: none; }
  .terminal-command { color: #fbbf24; }

  .terminal-output { display: flex; flex-direction: column; gap: 0.5rem; }

  .output-line  { display: flex; gap: 0.75rem; color: #d1d5db; }
  .output-header { font-weight: 600; color: #e5e7eb; }

  .tier-label { min-width: 160px; color: #9ca3af; }
  .tier-value { font-weight: 600; }

  .tier-hot  .tier-value { color: #f87171; }
  .tier-warm .tier-value { color: #fbbf24; }
  .tier-cold .tier-value { color: #6b7280; }

  .cost-line  { margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid rgba(255,255,255,0.08); }
  .cost-label { color: #9ca3af; }
  .cost-value { font-weight: 700; color: #4ade80; }

  /* Light mode */
  :root[data-theme='light'] .terminal-command { color: #92400e; }
  :root[data-theme='light'] .output-line      { color: #374151; }
  :root[data-theme='light'] .output-header    { color: #111827; }
  :root[data-theme='light'] .tier-label       { color: #6b7280; }
  :root[data-theme='light'] .tier-hot  .tier-value { color: #b91c1c; }
  :root[data-theme='light'] .tier-warm .tier-value { color: #92400e; }
  :root[data-theme='light'] .tier-cold .tier-value { color: #374151; }
  :root[data-theme='light'] .cost-line  { border-top-color: rgba(0,0,0,0.1); }
  :root[data-theme='light'] .cost-label { color: #6b7280; }
  :root[data-theme='light'] .cost-value { color: #15803d; }
</style>
